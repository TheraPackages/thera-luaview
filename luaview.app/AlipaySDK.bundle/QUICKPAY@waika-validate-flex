{"time":"0104","tplId":"QUICKPAY@waika-validate-flex","publishVersion":"150924","tag":"QUICKPAY","name":"waika-validate-flex","data":{"tag":"html","children":[{"tag":"head","children":[{"tag":"script","src":"waika-validate.js"},{"tag":"meta","src":"AlipaySDK.bundle/amc.i18n","type":"i18n"},{"tag":"link","rel":"stylesheet","href":"AlipaySDK.bundle/amc.css"},{"tag":"script","src":"AlipaySDK.bundle/amc.js"},{"tag":"script","children":[{"text":"var getTag=amc.fn.getById;var hide=amc.fn.hide;var show=amc.fn.show;var path=amc.path+\"alipay_msp_\";var loadImg=path+\"loading_blue.gif\";var successImg=path+\"success_blue.gif\";var p_array=new Array();var dot_array=new Array();var validate=\"\";var cvv2=\"\";function init(){var a=amc.fn.iNav(amc.res.close,\"{{confirm_pay}}\",null,null,onBack,null);getTag(\"body\").insertBefore(a,getTag(\"iLine\"));getTag(\"dateInput\").focus();p_array=document.querySelectorAll(\".amc-num-item\");dot_array=document.querySelectorAll(\".amc-black-point\")}function onpay_success(){getTag(\"loadGif\").src=successImg;getTag(\"pwd_load_text\").innerText=\"{{pay_ok}}\"}function submit(){var b={action:{name:\"/cashier/cardValidate\",host:flybird.rpcData.pci_url,https:true,neec:\"6004\",loadtxt:\"\",enctype:\"application/x-www-form-urlencoded\",request_param:\"requestData\"}};var a={validate:validate};a.cvv2=cvv2;b.param=a;getTag(\"dateInput\").blur();getTag(\"loadGif\").src=loadImg;show(\"pwd_load\");document.asyncSubmit(b,function(c){if(c.status==\"0001\"){onpay_success()}else{if(c.status==\"0000\"){getTag(\"dateInput\").value=\"\";getTag(\"dateInput\").focus();getTag(\"loadGif\").src=\"\";hide(\"pwd_load\");onDateInput()}}})}function onBack(){document.confirm({title:\"\",message:\"{{confirm_cancel_pay}}\",okButton:\"{{confirm_btn}}\",cancelButton:\"{{cancel}}\"},function(a){if(a.ok){document.submit({action:{name:\"loc:exit\"}})}})}function requestFocus(){getTag(\"dateInput\").focus()}function onDateInput(){var a=getTag(\"dateInput\");var c=a.value;for(var b=0;b<4;b++){p_array[b].innerText=\"\"}validate=\"\";for(var b=0;b<c.length&&b<4;b++){p_array[b].innerText=c.substr(b,1);validate=validate+c.substr(b,1)}for(var b=0;b<3;b++){hide(dot_array[b])}cvv2=\"\";for(var b=4;b<c.length&&b<7;b++){show(dot_array[b-4]);cvv2=cvv2+c.substr(b,1)}if(c.length>=7){a.value=c.substr(0,7)||\"\";submit()}}function onKeyDown(){if(event.which==4){onBack()}};","tag":"text"}]}]},{"id":"body","onload":"init()","tag":"body","children":[{"id":"iLine","tag":"div","css":"amc-1px-title-line"},{"tag":"div","css":"amc-abs-space-v-s"},{"tag":"div","children":[{},{"tag":"div","css":"amc-flex-space-1"},{"tag":"div","children":[{"tag":"div","children":[{"tag":"label","children":[{"text":"{{waika_validity}}","tag":"text"}],"css":"amc-font-m"}],"css":"amc-pd-tb"},{"id":"validate","tag":"div","children":[{"tag":"div","children":[{"id":"p0","tag":"label","css":"amc-num-item"},{"tag":"div","css":"amc-adapt-num-line"},{"id":"p1","tag":"label","css":"amc-num-item"},{"tag":"div","css":"amc-adapt-num-line"},{"id":"p2","tag":"label","css":"amc-num-item"},{"tag":"div","css":"amc-adapt-num-line"},{"id":"p3","tag":"label","css":"amc-num-item"}],"css":"amc-num-box"}],"onclick":"requestFocus();","css":"amc-flex-center"}],"css":"amc-v-box"},{"tag":"div","css":"amc-flex-space-2"},{},{"tag":"div","children":[{"tag":"div","children":[{"tag":"label","children":[{"text":"{{waika_cvv}}","tag":"text"}],"css":"amc-font-m"}],"css":"amc-pd-tb"},{"id":"cvv","tag":"div","children":[{"tag":"div","children":[{"tag":"div","children":[{"tag":"div","css":"amc-black-point"}],"css":"amc-flex-1 amc-flex-center"},{"tag":"div","css":"amc-adapt-num-line"},{"tag":"div","children":[{"tag":"div","css":"amc-black-point"}],"css":"amc-flex-1 amc-flex-center"},{"tag":"div","css":"amc-adapt-num-line"},{"tag":"div","children":[{"tag":"div","css":"amc-black-point"}],"css":"amc-flex-1 amc-flex-center"}],"css":"amc-num-box amc-num-box-4-3"}],"onclick":"requestFocus();","css":"amc-flex-center"}],"css":"amc-v-box"},{"tag":"div","css":"amc-flex-space-1"}],"css":"amc-pad-tb"},{"id":"dateInput","keyboard":"safe","tag":"input","value":"","type":"number","css":"amc-hidden","oninput":"onDateInput()"},{},{"id":"pwd_load","tag":"div","children":[{"tag":"div","css":"amc-flex-space-1"},{"id":"loadGif","tag":"img","css":"amc-load-img"},{"tag":"div","css":"amc-abs-space-v-l"},{"tag":"div","children":[{"id":"pwd_load_text","tag":"label","children":[{"text":"{{paying}}","tag":"text"}],"css":"amc-font-l-white"}],"css":"amc-justify-center"},{"tag":"div","css":"amc-flex-space-2"}],"css":"amc-loading-box"}],"onkeydown":"onKeyDown();","css":"amc-i-body"}]},"format":"JSON","tplVersion":"5.0.2"}