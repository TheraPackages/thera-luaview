{"time":"0022","tplId":"QUICKPAY@cashier-card-detail-flex","publishVersion":"150924","tag":"QUICKPAY","name":"cashier-card-detail-flex","data":{"tag":"html","children":[{"tag":"head","children":[{"tag":"script","src":"cashier-card-detail-flex.js"},{"tag":"meta","src":"AlipaySDK.bundle/amc.i18n","type":"i18n"},{"tag":"script","src":"AlipaySDK.bundle/amc.js"},{"tag":"link","rel":"stylesheet","href":"AlipaySDK.bundle/amc.css"},{"tag":"script","children":[{"text":"var getTag=amc.fn.getById;var hide=amc.fn.hide;var show=amc.fn.show;var rpc=amc.rpcData;var path=amc.path+\"alipay_msp_\";var infoPng=path+\"info\";var cvvDlgPng=path+\"cvv\";var validateDlgPng=path+\"validate\";var phoneDlgPng=path+\"phone_info\";var needInput=rpc.needinput;var userName=(needInput.username&&needInput.username.value)||\"\";var certNo=(needInput.certno&&needInput.certno.value)||\"\";var certType=(needInput.certtype&&needInput.certtype[\"default\"])||\"\";if(needInput.bankmobile===undefined){needInput.bankmobile={disable:true,display:false}}var bankMobile=needInput.bankmobile.value||\"\";var certTypeTextArray=new Array();var certTypeValueArray=new Array();var currentValue=\"\";function showProtocol(){amc.fn.showProtocolList(rpc.protocols)}function updateInputState(a,b){if(a.value.length){hide(b)}else{show(b)}}function checkInput(a,b){updateInputState(a,b);updateSubmitState()}function updateSubmitState(){var a=document.getElementsByTagName(\"input\");var c=false;for(var b=0;b<a.length;b++){if((!rpc.cvv2)&&(a[b].id===\"cvv2\")){continue}if((!rpc.validate)&&(a[b].id===\"validate\")){continue}if((!needInput.bankmobile.display)&&(a[b].id===\"bankMobile\")){continue}if(a[b].value===undefined||a[b].value===\"\"){c=true;break}}getTag(\"submit\").disabled=c;getTag(\"btnText\").style.color=c?\"#d2d2d2\":\"#fff\"}function onCvv2Input(){var a=getTag(\"cvv2\");checkInput(a,getTag(\"cvvInfoLayout\"))}function onValidateInput(){var a=getTag(\"validate\");checkInput(a,getTag(\"validateInfoLayout\"))}function onPhoneInput(){var a=getTag(\"bankMobile\");checkInput(a,getTag(\"phoneInfoLayout\"))}function onSubmit(){var k=certType;if(needInput.certtype){k=currentValue}var d={};if(rpc.isCredit){d.action={name:\"/card/sign\",neec:\"6004\",host:rpc.pci_url,https:true,enctype:\"application/x-www-form-urlencoded\",request_param:\"requestData\"}}else{d.action={name:\"/card/sign\",neec:\"6004\"}}d.action[\"params\"]={cardtype:rpc.cardtype,bankcode:rpc.bankcode,ccdctoken:rpc.ccdctoken,hidden_card_no:rpc.hidden_card_no};d.param={};var l=getTag(\"userName\");if(l&&l.value!=userName){d.param[\"username\"]=l.value}var j=getTag(\"certNo\");if(j&&j.value!=certNo){d.param[\"certno\"]=j.value;if(k==\"A\"){var b=\"(^\\\\d{15}$)|(^\\\\d{17}([0-9]|X)$)\";var g=j.value;var c=g.match(b);if(c==undefined){document.toast({text:\"{{input_right_id_card}}\",type:\"fail\"},function(){j.focus()});return}}}if(needInput.certtype){var i=getTag(\"certType\");if(i&&currentValue!=certType){d.param[\"certtype\"]=currentValue}}var e=getTag(\"bankMobile\");if(e&&e.value!=bankMobile){d.param[\"bankmobile\"]=e.value;var b=\"^1\\\\d{10}$\";var g=e.value;var c=g.match(b);if(c==undefined){document.toast({text:\"{{input_right_phone}}\",type:\"fail\"},function(){e.focus()});return}}amc.fn.hideKeyboard();if(rpc.cvv2){var f=getTag(\"cvv2\");if(f){d.param[\"cvv2\"]=f.value}}if(rpc.validate){var h=getTag(\"validate\");if(h){var a=h.value;a=a.replace(\"/\",\"\");d.param[\"validate\"]=a}}d.action[\"loadtxt\"]=\"\";document.asyncSubmit(d,function(m){if(m.pageloading===\"0\"){amc.fn.show(\"btnText\");amc.fn.hide(\"loading\")}else{if(m.pageloading===\"1\"){amc.fn.hide(\"btnText\");amc.fn.show(\"loading\")}}});amc.fn.show(\"loading\");if(amc.isAndroid){getTag(\"loading\").src=amc.path+\"alipay_msp_indicator_white_loading\"}else{getTag(\"loading\").style.color=\"#fff\"}amc.fn.hide(\"btnText\")}function onClickCvv(){var a=\"{{cvv_info}}\";var b=\"{{cvv}}\";getTag(\"dlgImg\").src=cvvDlgPng;getTag(\"dlgText\").innerText=a;getTag(\"dlgTitle\").innerText=b;getTag(\"dlg\").showModal()}function onClickValidate(){var c=\"{{validity}}\";var a=\"{{validity_info}}\";var b=validateDlgPng;getTag(\"dlgImg\").src=b;getTag(\"dlgText\").innerText=a;getTag(\"dlgTitle\").innerText=c;getTag(\"dlg\").showModal()}function onClickCertType(){if(needInput.certno.disable){return}var a={btns:certTypeTextArray,\"default\":certTypeTextArray.indexOf(currentValue),title:\"{{sel_id_no}}\"};document.picker(a,function(d){var c=d.index;var b=currentValue;currentValue=certTypeValueArray[c];getTag(\"certType\").innerText=certTypeTextArray[c];var e=\"{{please_input}}\"+certTypeTextArray[c]+\"{{no}}\";getTag(\"certNo\").placeholder=e;if(b!=currentValue){getTag(\"certNo\").value=\"\";updateSubmitState()}})}function onClickPhone(){getTag(\"dlgImg\").src=phoneDlgPng;getTag(\"dlgText\").innerText=\"{{phone_info}}\";getTag(\"dlgTitle\").innerText=\"{{phone}}\";getTag(\"dlg\").showModal()}function init(){var e=amc.fn.getNav(amc.res.navBack,\"{{return}}\",\"{{write_card_info}}\",null,null,onBack,null);getTag(\"body\").insertBefore(e,getTag(\"mainBody\"));getTag(\"cvvInfoImg\").src=infoPng;getTag(\"validateInfo\").src=infoPng;getTag(\"phoneInfo\").src=infoPng;var d=getTag(\"certType\");if(rpc.cvv2&&rpc.validate){getTag(\"centerLineTop\").className+=\" amc-margin-l\"}else{if(rpc.cvv2){hide(\"validateArea\")}else{if(rpc.validate){hide(\"cvvArea\")}else{hide(\"validateArea\");hide(\"cvvArea\");hide(\"emptyBox\")}}}if(!needInput.bankmobile.display){hide(\"bankMobileBox\")}if(needInput.certtype){var b=needInput.certtype.value;var d=getTag(\"certType\");if(b){for(var c in b){var a=b[c];certTypeTextArray.push(c);certTypeValueArray.push(a);if(a===needInput.certtype[\"default\"]){currentValue=a;d.selectedIndex=certTypeTextArray.length-1;if(c){getTag(\"certNo\").placeholder=\"{{please_input}}\"+c+\"{{no}}\";getTag(\"certType\").innerText=c}}}}}else{getTag(\"certNo\").placeholder=\"{{input_id_no}}\"}getTag(\"bankName\").innerText=rpc.bankname||\"\";getTag(\"cardType\").innerText=rpc.isCredit?\"{{credit_card}}\":\"{{store_card}}\";getTag(\"userName\").value=userName;if(needInput.username.disable){getTag(\"userName\").disabled=true;getTag(\"userName\").style.color=\"#a5a5a5\"}getTag(\"certNo\").value=certNo;if(needInput.certno.disable){getTag(\"certNo\").disabled=true;getTag(\"certNo\").style.color=\"#a5a5a5\";getTag(\"certType\").style.color=\"#a5a5a5\"}getTag(\"bankMobile\").value=bankMobile;if(needInput.bankmobile.disable){getTag(\"bankMobile\").disabled=true;getTag(\"bankMobile\").style.color=\"#a5a5a5\"}if(needInput.certtype===undefined||(needInput.certno.disable&&needInput.certtype[\"default\"]===undefined)){hide(\"certTypeArea\")}updateSubmitState();onPhoneInput()}function onBack(){amc.fn.hideKeyboard();document.submit({action:{name:\"loc:back\"}})}function onSelectChange(){var d=getTag(\"certType\");var b=d.selectedIndex;var a=getTag(\"certNo\").placeholder;var c=\"{{please_input}}\"+certTypeTextArray[b]+\"{{no}}\";getTag(\"certNo\").placeholder=c;if(a!==c){getTag(\"certNo\").value=\"\";updateSubmitState()}}function onKeyDown(){if(event.which==4){onBack()}};","tag":"text"}]},{"tag":"style","children":[{"text":".info-img {\n    justify-content: flex-end;\n    align-items: center;\n}\n.amc-nav-r-box {\n    display: none;\n}\n.amc-cell-l-box{\n    width:75px;\n    padding-right: 5px;\n}","tag":"text"}]}]},{"fullscreen":"true","id":"body","onload":"init()","tag":"body","children":[{"id":"mainBody","tag":"div","children":[{},{"tag":"div","children":[{"tag":"label","children":[{"text":"{{info_sec}}","tag":"text"}],"css":"amc-cell-footer-text amc-flex-1 amc-font-xs"}],"css":"amc-pd-lr amc-pd-b-s"},{},{"tag":"div","css":"amc-1px-line"},{"tag":"div","children":[{"tag":"div","children":[{"tag":"label","children":[{"text":"{{card_type}}","tag":"text"}],"css":"amc-cell-l-text amc-flex-1"}],"css":"amc-cell-l-box"},{"tag":"div","children":[{"id":"bankName","tag":"label","css":"amc-cell-l-text"},{"id":"cardType","tag":"label","css":"amc-cell-l-text margin-l-l"}],"css":"amc-align-center"}],"css":"amc-cell amc-pd"},{"tag":"div","css":"amc-1px-line"},{},{"tag":"div","css":"amc-abs-space-v-l"},{"tag":"div","css":"amc-1px-line"},{"id":"cvvArea","tag":"div","children":[{"tag":"div","children":[{"tag":"div","children":[{"tag":"label","children":[{"text":"{{cvv_text}}","tag":"text"}],"css":"amc-cell-l-text"}],"css":"amc-cell-l-box"},{"tag":"div","children":[{"id":"cvv2","maxlength":"3","placeholder":"{{card_three_num}}","tag":"input","value":"","type":"number","css":"amc-input","oninput":"onCvv2Input()"}],"css":"amc-cell-m-box"},{"id":"cvvInfoLayout","tag":"div","children":[{"id":"cvvInfoImg","alt":"{{info}}","tag":"img","onclick":"onClickCvv()","css":"amc-info-img"}],"css":"amc-btn-img info-img"}],"css":"amc-cell amc-pd"},{"id":"centerLineTop","tag":"div","css":"amc-1px-line"}],"css":"amc-bg-white amc-v-box"},{},{"id":"validateArea","tag":"div","children":[{"tag":"div","children":[{"tag":"div","children":[{"tag":"label","children":[{"text":"{{validity_text}}","tag":"text"}],"css":"amc-cell-l-text amc-flex-1"}],"css":"amc-cell-l-box"},{"tag":"div","children":[{"id":"validate","placeholder":"{{month_year}}","tag":"input","value":"","type":"month","css":"amc-input","oninput":"onValidateInput()"}],"css":"amc-cell-m-box"},{"id":"validateInfoLayout","tag":"div","children":[{"id":"validateInfo","alt":"{{info}}","tag":"img","onclick":"onClickValidate()","css":"amc-info-img"}],"css":"amc-btn-img info-img"}],"css":"amc-cell amc-pd"},{"tag":"div","css":"amc-1px-line"}],"css":"amc-v-box amc-bg-white"},{"id":"emptyBox","tag":"div","css":"amc-abs-space-v-l"},{"tag":"div","children":[{},{"tag":"div","css":"amc-1px-line"},{"tag":"div","children":[{"tag":"div","children":[{"tag":"label","children":[{"text":"{{name}}","tag":"text"}],"css":"amc-cell-l-text"}],"css":"amc-cell-l-box"},{"tag":"div","children":[{"id":"userName","placeholder":"{{input_name}}","tag":"input","value":"","css":"amc-input","oninput":"updateSubmitState()"}],"css":"amc-cell-m-box"}],"css":"amc-cell amc-pd"},{},{"id":"certTypeArea","tag":"div","children":[{"tag":"div","css":"amc-1px-line amc-margin-l"},{"tag":"div","children":[{"tag":"div","children":[{"tag":"label","children":[{"text":"{{papers_type}}","tag":"text"}],"css":"amc-cell-l-text amc-flex-1"}],"css":"amc-cell-l-box"},{"tag":"div","children":[{"id":"certType","tag":"label","children":[{"text":"{{papers_type}}","tag":"text"}],"onclick":"onClickCertType();","css":"amc-font-m amc-theme-color"}],"css":"amc-cell-m-box"}],"css":"amc-cell amc-pd"}],"css":"amc-v-box"},{"tag":"div","css":"amc-1px-line amc-margin-l"},{},{"tag":"div","children":[{"tag":"div","children":[{"tag":"label","children":[{"text":"{{id_no}}","tag":"text"}],"css":"amc-cell-l-text amc-flex-1"}],"css":"amc-cell-l-box"},{"tag":"div","children":[{"id":"certNo","placeholder":"","tag":"input","value":"","css":"amc-input","oninput":"updateSubmitState()"}],"css":"amc-cell-m-box"}],"css":"amc-cell amc-pd"},{"tag":"div","css":"amc-1px-line"}],"css":"amc-v-box amc-bg-white"},{"id":"emptyBox","tag":"div","css":"amc-abs-space-v-l"},{},{"id":"bankMobileBox","tag":"div","children":[{"tag":"div","css":"amc-1px-line"},{"tag":"div","children":[{"tag":"div","children":[{"tag":"label","children":[{"text":"{{phone_no}}","tag":"text"}],"css":"amc-cell-l-text amc-flex-1"}],"css":"amc-cell-l-box"},{"tag":"div","children":[{"id":"bankMobile","placeholder":"{{input_bank_phone}}","tag":"input","value":"","type":"number","css":"amc-input","oninput":"onPhoneInput();"}],"css":"amc-cell-m-box"},{"id":"phoneInfoLayout","tag":"div","children":[{"id":"phoneInfo","alt":"{{info}}","tag":"img","onclick":"onClickPhone()"}],"css":"amc-btn-img info-img"}],"css":"amc-cell amc-pd"}],"css":"amc-v-box"},{},{"tag":"div","css":"amc-1px-line"},{"tag":"div","children":[{"tag":"label","children":[{"text":"{{agree}}","tag":"text"}],"css":"amc-protocol-text amc-margin-r-xs"},{"tag":"div","children":[{"tag":"label","children":[{"text":"{{serve_protocol_full}}","tag":"text"}],"onclick":"showProtocol()","css":"amc-font-m amc-theme-color"}]}],"css":"amc-align-center amc-pd-l amc-margin-b-l amc-pd-t-l"},{},{"tag":"div","children":[{"text":"？ ？","tag":"text"},{"id":"submit","tag":"div","children":[{"id":"loading","tag":"img","src":"indicatior","css":"amc-loading-img amc-hidden"},{"id":"btnText","tag":"label","children":[{"text":"{{next}}","tag":"text"}],"css":"amc-btn-disabled-color amc-font-super-l"}],"onclick":"onSubmit();","disabled":"true","css":"amc-btn-primary amc-justify-center amc-align-center"}],"css":"amc-pd-lr amc-pd-b"}],"css":"amc-main amc-scroll-android"},{"id":"dlg","tag":"dialog","children":[{"id":"dlgTitle","tag":"label","css":"amc-dlg-title"},{"tag":"div","children":[{"id":"dlgImg","tag":"img"}],"css":"amc-justify-center"},{"id":"dlgText","tag":"label","css":"amc-dlg-txt"},{"tag":"div","css":"amc-adapt-line amc-dlg-width"},{"tag":"button","children":[{"text":"{{i_know_it}}","tag":"text"}],"onclick":"getTag('dlg').close();","css":"amc-theme-color amc-dlg-btn"}],"css":"amc-dlg-box amc-v-box"}],"onkeydown":"onKeyDown();","css":"amc-body"}]},"format":"JSON","tplVersion":"5.0.3"}