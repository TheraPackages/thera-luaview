{"time":"0006","tplId":"QUICKPAY@cashier-new-wk-card-flex","publishVersion":"150924","tag":"QUICKPAY","name":"cashier-new-wk-card-flex","data":{"tag":"html","children":[{"tag":"head","children":[{"tag":"script","src":"cashier-new-wk-card-flex.js"},{"tag":"meta","src":"AlipaySDK.bundle/amc.i18n","type":"i18n"},{"tag":"link","rel":"stylesheet","href":"AlipaySDK.bundle/amc.css"},{"tag":"script","src":"AlipaySDK.bundle/amc.js"},{"tag":"script","children":[{"text":"var rpc=amc.rpcData;var getTag=amc.fn.getById;var path=amc.path+\"alipay_msp_\";var infoPng=path+\"info\";var needInput=rpc.needinput;function updateInputState(a,b){if(a.value.length){amc.fn.hide(b)}else{amc.fn.show(b)}}function checkInput(a,b){updateInputState(a,b);updateSubmitState()}function updateSubmitState(){var a=document.getElementsByTagName(\"input\");var c=false;for(var b=0;b<a.length;b++){if(a[b].value===\"\"){c=true;break}}if(getTag(\"receiveaddress\").innerText==\"\"){c=true}getTag(\"submit\").disabled=c}function onCvv2Input(){var a=getTag(\"cvv2\");checkInput(a,getTag(\"cvv2InfoImg\"))}function onValidateInput(){var a=getTag(\"validate\");checkInput(a,getTag(\"validateInfoPng\"))}function onclickCvv(){getTag(\"dlg_img\").src=path+\"cvv\";getTag(\"dlg_text\").innerText=\"{{cvv_info}}\";getTag(\"dlg_title\").innerText=\"{{cvv}}\";getTag(\"dlg\").showModal()}function onClickValidate(){getTag(\"dlg_img\").src=path+\"validate\";getTag(\"dlg_text\").innerText=\"{{validity_info}}\";getTag(\"dlg_title\").innerText=\"{{validity}}\";getTag(\"dlg\").showModal()}function onClickBill(){var d={action:{name:\"/card/wkSetBillAddress\"}};d.action[\"params\"]={};d.action[\"params\"][\"call_init\"]=true;var c={};var a=document.querySelectorAll(\"input\");for(var b=0;b<a.length;b++){if(a[b].value){if(a[b].id===\"validate\"){c[a[b].id]=unformatExpireDate(a[b].value)}else{c[a[b].id]=a[b].value}}}d.param=c;document.submit(d)}function onSubmit(){var c=getTag(\"email\");var h=\"^([a-zA-Z0-9_.-])+@(([a-zA-Z0-9-])+.)+([a-zA-Z0-9]{2,4})+$\";var g=c.value;var a=g.match(h);if(a==undefined){document.toast({text:\"{{email_f_error}}\",type:\"fail\"},function(){c.focus()});return}var f={action:{name:\"/card/sign\",loadtxt:\"\"}};f.action[\"neec\"]=\"6004\";f.action[\"host\"]=rpc.pci_url;f.action[\"https\"]=true;f.action[\"enctype\"]=\"application/x-www-form-urlencoded\";f.action[\"request_param\"]=\"requestData\",f.action[\"params\"]={};f.action[\"params\"][\"cardtype\"]=\"WAI_KA\";f.action[\"params\"][\"ccdctoken\"]=rpc.ccdctoken;var e={};var b=document.querySelectorAll(\"input\");for(var d=0;d<b.length;d++){if(b[d].value){if(b[d].id===\"validate\"){e[b[d].id]=unformatExpireDate(b[d].value)}else{e[b[d].id]=b[d].value}}}f.param=e;document.asyncSubmit(f,function(i){amc.fn.shouldShowBtnIndicator(i,\"submit\",\"loading\")});amc.fn.shouldShowBtnIndicator({pageloading:\"1\"},\"submit\",\"loading\")}function onBack(){amc.fn.exitConfirm(\"{{confirm_cancel_pay}}\")}function init(){var d=amc.fn.getNav(amc.res.navBack,\"{{return}}\",\"{{write_card_info}}\",null,null,onBack,null);getTag(\"body\").insertBefore(d,getTag(\"mainBody\"));if(amc.isAndroid){getTag(\"loading\").src=amc.path+\"alipay_msp_indicator_white_loading\"}var a=getTag(\"cvv2InfoImg\");var b=getTag(\"validateInfoPng\");var e=getTag(\"cvv2\");var c=getTag(\"validate\");a.src=infoPng;b.src=infoPng;getTag(\"billAddrRightArrow\").src=amc.res.arrowRight;if(needInput){getTag(\"cardname\").innerText=(needInput.cardname&&needInput.cardname.value)||\"\";getTag(\"familyname\").value=(needInput.familyname&&needInput.familyname.value)||\"\";getTag(\"forename\").value=(needInput.forename&&needInput.forename.value)||\"\";c.value=(needInput.validate&&formatExpireDate(needInput.validate.value))||\"\";e.value=(needInput.cvv2&&needInput.cvv2.value)||\"\";getTag(\"receiveaddress\").innerText=(needInput.receiveaddress&&needInput.receiveaddress.value)||\"\";getTag(\"email\").value=(needInput.email&&needInput.email.value)||\"\"}checkInput(e,a);checkInput(c,b)}function onKeyDown(){if(event.which==4){onBack()}}function unformatExpireDate(a){if(a){return a.replace(\"/\",\"\")}else{return a||\"\"}}function formatExpireDate(a){if(a&&a.length===4&&(a.indexOf(\"/\")<0)){return a.substr(0,2)+\"/\"+a.substr(2)}else{return a||\"\"}};","tag":"text"}]},{"tag":"style","children":[{"text":".amc-nav-r-box {\n    display: none;\n}\n.name {\n    font-size: 16px;\n    margin-right: 5px;\n    color: #000;\n}","tag":"text"}]}]},{"id":"body","onload":"init()","tag":"body","children":[{"id":"mainBody","tag":"div","children":[{},{"tag":"div","css":"amc-1px-line"},{"tag":"div","children":[{"tag":"div","children":[{"tag":"label","children":[{"text":"{{card_type}}","tag":"text"}],"css":"amc-cell-l-text amc-flex-1"}],"css":"amc-cell-l-box-reset"},{"id":"cardNameDiv","tag":"div","children":[{"id":"cardname","tag":"label","css":"amc-cell-l-text"}],"css":"amc-cell-m-box"}],"css":"amc-cell amc-cell-reset amc-pd-lr"},{},{"tag":"div","css":"amc-1px-line"},{"tag":"div","css":"amc-abs-space-v-l"},{"tag":"div","css":"amc-1px-line"},{},{"tag":"div","children":[{"tag":"div","children":[{"tag":"label","children":[{"text":"{{last_name}}","tag":"text"}],"css":"name amc-flex-1"}],"css":"amc-cell-l-box-reset"},{"tag":"div","children":[{"id":"familyname","placeholder":"{{last_name}}","tag":"input","value":"","css":"amc-input","oninput":"updateSubmitState()"}],"css":"amc-flex-1"},{"tag":"div","css":"amc-cell-v-line"},{"tag":"div","css":"amc-abs-space-h-s"},{"tag":"div","children":[{"tag":"label","children":[{"text":"{{first_name}}","tag":"text"}],"css":"name amc-flex-1"}],"css":"amc-cell-l-box-reset"},{"tag":"div","children":[{"id":"forename","placeholder":"{{first_name}}","tag":"input","value":"","css":"amc-input","oninput":"updateSubmitState()"}],"css":"amc-flex-1"}],"css":"amc-cell amc-cell-reset amc-pd-lr"},{"tag":"div","css":"amc-1px-line amc-margin-l"},{},{"tag":"div","children":[{"tag":"div","children":[{"tag":"label","children":[{"text":"{{validity_text}}","tag":"text"}],"css":"amc-cell-l-text amc-flex-1"}],"css":"amc-cell-l-box-reset"},{"tag":"div","children":[{"id":"validate","placeholder":"{{month_year}}","tag":"input","value":"","type":"month","css":"amc-input","oninput":"onValidateInput()"}],"css":"amc-cell-m-box"},{"tag":"div","children":[{"id":"validateInfoPng","tag":"img","onclick":"onClickValidate()"}]}],"css":"amc-cell amc-cell-reset amc-pd-lr"},{"tag":"div","css":"amc-1px-line amc-margin-l"},{},{"tag":"div","children":[{"tag":"div","children":[{"tag":"label","children":[{"text":"{{cvv_text}}","tag":"text"}],"css":"amc-cell-l-text"}],"css":"amc-cell-l-box-reset"},{"tag":"div","children":[{"id":"cvv2","maxlength":"3","placeholder":"{{card_three_num}}","tag":"input","value":"","type":"number","css":"amc-input","oninput":"onCvv2Input()"}],"css":"amc-cell-m-box"},{"tag":"div","children":[{"id":"cvv2InfoImg","tag":"img","onclick":"onclickCvv()"}]}],"css":"amc-cell amc-cell-reset amc-pd-lr"},{},{"tag":"div","css":"amc-1px-line"},{"tag":"div","css":"amc-abs-space-v-l"},{"tag":"div","css":"amc-1px-line"},{},{"tag":"div","children":[{"tag":"div","children":[{"tag":"label","children":[{"text":"{{email}}","tag":"text"}],"css":"amc-cell-l-text amc-flex-1"}],"css":"amc-cell-l-box-reset"},{"tag":"div","children":[{"id":"email","placeholder":"{{input_email}}","tag":"input","value":"","css":"amc-input","oninput":"updateSubmitState()"}],"css":"amc-cell-m-box amc-flex-1"}],"css":"amc-cell amc-cell-reset amc-pd-lr"},{},{"tag":"div","css":"amc-1px-line"},{"tag":"div","css":"amc-abs-space-v-l"},{"tag":"div","css":"amc-1px-line"},{},{"tag":"div","children":[{"tag":"div","children":[{"tag":"label","children":[{"text":"{{bill_address}}","tag":"text"}],"css":"amc-cell-l-text amc-flex-1"}],"css":"amc-cell-l-box-reset amc-align-self-start"},{"tag":"div","children":[{"id":"receiveaddress","tag":"label","css":"amc-cell-l-text amc-flex-1"}],"css":"amc-cell-m-box amc-pd-r amc-align-self-start"},{"id":"billAddrRightArrow","tag":"img"}],"onclick":"onClickBill()","css":"amc-large-cell amc-pd-lr amc-pd-t-s amc-pd-b-s amc-height-auto"},{"tag":"div","css":"amc-1px-line"},{"tag":"div","css":"amc-abs-space-v-xxl "},{},{"tag":"div","children":[{"id":"loading","tag":"img","src":"indicatior","css":"amc-loading-img amc-text-white-clolor amc-hidden"},{"id":"submit","tag":"button","children":[{"text":"{{next}}","tag":"text"}],"onclick":"onSubmit()","css":"amc-btn-primary","disabled":"true"}],"css":"amc-margin-lr amc-margin-b amc-align-center amc-justify-center amc-btn-primary"}],"css":"amc-main amc-scroll-android"},{"id":"dlg","tag":"dialog","children":[{"id":"dlg_title","tag":"label","css":"amc-dlg-title"},{"tag":"div","children":[{"id":"dlg_img","tag":"img"}],"css":"amc-justify-center"},{"id":"dlg_text","tag":"label","css":"amc-dlg-txt"},{"tag":"div","css":"amc-adapt-line amc-dlg-width"},{"id":"btn_main","tag":"button","children":[{"text":"{{i_know_it}}","tag":"text"}],"onclick":"getTag('dlg').close()","css":"amc-theme-color amc-dlg-btn"}],"css":"amc-dlg-box amc-v-box"}],"onkeydown":"onKeyDown();","css":"amc-body"}]},"format":"JSON","tplVersion":"5.0.4"}