{"time":"0017","tplId":"QUICKPAY@cashier-error-follow-action-flex","publishVersion":"150924","tag":"QUICKPAY","name":"cashier-error-follow-action-flex","data":{"tag":"html","children":[{"tag":"head","children":[{"tag":"meta","src":"AlipaySDK.bundle/amc.i18n","type":"i18n"},{"tag":"link","rel":"stylesheet","href":"AlipaySDK.bundle/amc.css"},{"tag":"script","src":"AlipaySDK.bundle/amc.js"},{"tag":"script","children":[{"text":"var getTag = amc.fn.getById;\n        var create = amc.fn.create;\n        // 没有btns下发时的默认按钮\n        var defaultButton = [{\n            'act': {'name': 'loc:exit', 'params': ''},\n            'txt': '{{confirm_btn}}'\n        }];\n\n        if (!amc.rpcData.btns || !amc.rpcData.btns.length) {\n            amc.rpcData.btns = defaultButton;\n        }\n        // 初始化\n        function init() {\n            if (amc.rpcData.msg) {\n                getTag('errMsg').innerText = amc.rpcData.msg;\n            } else {\n                getTag('errMsg').innerText = '{{system_error}}!';\n            }\n\n            var createButtons = amc.isIOS ? iOSCreateButtons : androidCreateButtons;\n            createButtons(amc.rpcData.btns);\n\n            getTag('dlg').showModal();\n        }\n\n        /**\n         * iOS 创建所有按钮\n         */\n        function iOSCreateButtons(btnItems) {\n            // 设置dialog样式\n            getTag('dlg').className = 'ios-dlg-box amc-v-box';\n            getTag('errMsg').className = 'ios-msg amc-font-m';\n\n            var btnLength = btnItems.length;\n            var isHorizontal = (btnLength === 2);\n            var mainBody = getTag('mainBody');\n\n            // 横线\n            var line = create('div', 'amc-adapt-line', mainBody);\n            \n            // 创建button容器\n            var btnBoxClass = isHorizontal ? 'amc-align-center' : 'amc-v-box';\n            var btnBox = create('div', btnBoxClass, mainBody);\n            \n            var btnSepLineClass = isHorizontal ? 'btn-vertical-line' : 'amc-adapt-line';\n            \n            for (var i = 0; i < btnLength; i++) {\n                if (i !== 0) {\n                    // 按钮分隔线\n                    create('div', btnSepLineClass, btnBox);\n                }\n                iOSAddButon(btnBox, btnItems[i], isHorizontal);\n            }\n        }\n\n\n        /**\n         * iOS 添加按钮\n         */\n        function iOSAddButon(btnBox, btnItem, isHorizontal) {\n\n            // 创建button\n            var btnClass = isHorizontal ? 'amc-flex-1 ios-btn-div' : 'ios-btn-div';\n            var btn = create('div', btnClass, btnBox);\n            \n            // button文案\n            var text = create('label', 'btn-text amc-flex-1 amc-text-center amc-ellipsis', btn);\n            text.innerText = btnItem['txt'] || '';\n\n            btn.onclick = function () {\n                var act = (btnItem['act'] && btnItem['act']['name']) || '';\n                var obj = {'action': {'name': act + \";loc:destroy('cashier-error-follow-action-flex')\"}};   //销毁当前页面(从栈顶移除)\n                obj['action']['params'] = btnItem['act'] && btnItem['act']['params'];\n                //先close再销毁视图\n                getTag('dlg').close();\n                document.submit(obj);\n            }\n        }\n    \n        /**\n         * Android 创建所有按钮\n         */\n        function androidCreateButtons(btnItems) {\n            // 设置dialog样式\n            getTag('dlg').className = 'android-dlg-box amc-v-box';\n            // 安卓dilog边距为40px，为了防止pad中太大所以限定最大宽度\n            var androidDlgWidth = 480;\n            \n            if(window.innerWidth && window.innerWidth < 480) {\n                androidDlgWidth = window.innerWidth;\n            }\n            \n            getTag('dlg').style.width = androidDlgWidth - 80;\n            \n            getTag('errMsg').className = 'android-msg amc-font-m';\n\n            var btnLength = btnItems.length;\n            var isHorizontal = (btnLength <= 2);\n            var mainBody = getTag('mainBody');\n\n            // 创建button容器\n            var btnBoxClass = isHorizontal ? 'android-btn-box-horiz' : 'amc-v-box';\n            var btnBox = create('div', btnBoxClass, mainBody);\n            for (var i = 0; i < btnLength; i++) {\n                androidAddButon(btnBox, btnItems[i], isHorizontal);\n            }\n        }\n\n\n        //### 添加按钮\n        function androidAddButon(btnBox, btnItem, isHorizontal) {\n\n            var btnClass = isHorizontal ? 'android-btn-div-horiz' : 'android-btn-div-vert';\n            var textClass = (isHorizontal ? 'android-text-horiz ' : '') + ' btn-text amc-flex-1 amc-text-right amc-ellipsis';\n\n            var btn = create('div', btnClass, btnBox);\n            var text = create('label', textClass, btn);\n            text.innerText = btnItem['txt'] || '';\n\n            btn.onclick = function () {\n                var act = (btnItem['act'] && btnItem['act']['name']) || '';\n                var obj = {'action': {'name': act + \";loc:destroy('cashier-error-follow-action-flex')\"}};   //销毁当前页面(从栈顶移除)\n                obj['action']['params'] = btnItem['act'] && btnItem['act']['params'];\n                //先close再销毁视图\n                getTag('dlg').close();\n                document.submit(obj);\n            }\n        }\n        //### Android硬返回\n        function onKeyDown() {\n            if (event.which == 4) {\n                document.submit({'action': {'name': 'loc:exit'}});\n            }\n        }","tag":"text"}],"type":"text/javascript"},{"tag":"style","children":[{"text":".btn-text {\n            color: #108ee9;\n            margin: 12px 0;\n            font-size: 16px;\n        }\n\n        .btn-vertical-line {\n            width: 1px;\n            align-self: stretch;\n            background-color: #e5e5e5;\n        }\n\n        .amc-font-m {\n            font-size: 13px;\n            line-height: 16px;\n        }\n\n        .ios-msg {\n            flex: 1.0;\n            margin: 21px 15px;\n            text-align: center;\n        }\n\n        .ios-btn-div {\n            padding: 0 5px;\n            background-color: #fff;\n        }\n\n        .ios-btn-div:active {\n            background-color: #ddd;\n        }\n\n        .ios-dlg-box {\n            border: 0;\n            background-color: #fff;\n            border-radius: 13px;\n            width: 270px;\n        }\n\n        .android-msg {\n            flex: 1.0;\n            text-align: left;\n            margin: 10px 10px 15px 10px;\n        }\n\n        .android-btn-div-vert {\n            padding: 0 10px;\n            background-color: #fff;\n            justify-content: flex-end;\n        }\n\n        .android-btn-div-vert:active {\n            background-color: #ddd;\n        }\n\n        .android-btn-div-horiz {\n            padding: 0 10px;\n            border-radius: 2px;\n            background-color: #fff;\n        }\n\n        .android-btn-div-horiz:active {\n            background-color: #ddd;\n        }\n\n        .android-text-horiz {\n            max-width: 110px;\n        }\n\n        .android-dlg-box {\n            padding: 10px 10px;\n            border: 0;\n            background-color: #fff;\n            border-radius: 2px;\n        }\n\n        .android-btn-box-horiz {\n            align-items: center;\n            justify-content: flex-end;\n            padding-bottom: 3px;\n        }","tag":"text"}]}]},{"onload":"init()","tag":"body","children":[{"id":"dlg","tag":"dialog","children":[{"tag":"div","children":[{"id":"errMsg","tag":"label"}]},{"id":"mainBody","tag":"div","css":"amc-v-box amc-justify-center"}],"onkeydown":"onKeyDown()"}],"css":"amc-body amc-opacity"}]},"format":"JSON","tplVersion":"5.0.4"}